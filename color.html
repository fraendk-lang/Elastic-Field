<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Elastic Field — Color Tool</title>
<meta name="description" content="Pick a color and learn contrast at a glance (WCAG badges included).">

<style>
:root{
  --bg:#0b0c10; --panel:#121318; --ink:#e8ecf1; --sub:#a9b1bc; --line:#1d2028; --muted:#2a2e39;
  --radius:16px; --shadow:0 10px 25px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Arial}
a{color:var(--ink);text-decoration:none}
.wrap{max-width:1100px;margin:0 auto;padding:18px}

.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:var(--muted);cursor:pointer}
.btn:hover{transform:translateY(-1px)}
.btn.primary{background:linear-gradient(135deg,#d4a657,#8a5e20); color:#111}
.badge{display:inline-block;font-size:12px;padding:4px 9px;border-radius:999px;border:1px solid var(--line);background:var(--muted);color:var(--sub)}
.card{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow)}
h1{margin:0 0 6px}
.rainbow{background:linear-gradient(90deg,#ff7a7a,#ffd36d,#8fff9f,#6fd3ff,#bd8bff,#ff7ad9);
  -webkit-background-clip:text;background-clip:text;color:transparent;font-weight:800}

/* Tool grid */
.ct-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:18px}
.ct-left{grid-column:span 12}
.ct-center{grid-column:span 7}
.ct-right{grid-column:span 5}
@media(max-width:980px){.ct-center,.ct-right{grid-column:span 12}}

.ct-row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.ct-radio{display:flex;align-items:center;gap:8px}
.ct-radio input{accent-color:#00d1ff}
.ct-contrastline{margin-top:6px;padding:8px 10px;border:1px dashed var(--line);border-radius:10px;background:rgba(255,255,255,.02)}
.ct-badge{margin-left:8px;padding:2px 8px;border-radius:999px;border:1px solid var(--line);background:var(--muted);color:var(--sub);font-size:12px}
.ct-hint{color:var(--sub)}

.ct-inputrow{display:flex;gap:10px;align-items:center;margin-bottom:8px}
.ct-swatch{width:34px;height:22px;border-radius:6px;border:1px solid var(--line)}
.ct-label{display:block;margin:10px 0 6px;color:var(--sub);font-size:13px}
.ct-inputwrap{display:flex;gap:10px}
.ct-input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:#0f1116;color:var(--ink)}
.ct-input:focus{border-color:#2c8dd8;box-shadow:0 0 0 3px rgba(44,141,216,.25)}

.palette{
  min-height:220px;border-radius:12px;border:1px solid #283042;position:relative;overflow:auto;
  background: repeating-linear-gradient(0deg, rgba(255,255,255,.04) 0 1px, transparent 1px 24px),
              repeating-linear-gradient(90deg, rgba(255,255,255,.04) 0 1px, transparent 1px 24px),
              linear-gradient(180deg,#171b22,#1d2430);
  padding:12px;display:flex;flex-wrap:wrap;gap:10px
}
.palette-empty{color:var(--sub)}
.chip{width:64px;height:64px;border-radius:10px;border:1px solid rgba(0,0,0,.35);box-shadow:0 8px 18px rgba(0,0,0,.35);position:relative;cursor:pointer}
.chip b{position:absolute;left:6px;bottom:6px;font:700 10px/1.1 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;color:rgba(255,255,255,.92);text-shadow:0 1px 2px rgba(0,0,0,.55)}
</style>
</head>
<body>
  <div class="wrap" style="display:flex;justify-content:space-between;gap:10px;align-items:center;flex-wrap:wrap">
    <div>
      <h1><span class="rainbow">Color</span> <span class="badge">tool</span></h1>
      <p class="kicker" style="color:#a9b1bc;margin:4px 0 10px">Pick a color and learn contrast at a glance.</p>
    </div>
    <a class="btn" href="index.html">← Back to site</a>
  </div>

  <section>
    <div class="wrap">
      <div class="ct-grid">
        <div class="ct-left card" style="padding:14px">
          <div class="ct-row">
            <label class="ct-radio"><input type="radio" name="ct-mode" value="bg" checked><span>Color as background</span></label>
            <label class="ct-radio"><input type="radio" name="ct-mode" value="text"><span>Color as text</span></label>
            <button class="btn" id="ct-swap">Swap</button>
          </div>
          <div id="ct-contrast" class="ct-contrastline">Contrast vs panel: <b id="ct-ratio">–</b><span id="ct-badge" class="ct-badge">–</span></div>
          <small class="ct-hint">WCAG: AAA ≥ 7.0, AA ≥ 4.5 (normal), AA-large ≥ 3.0</small>
        </div>

        <div class="ct-center card" style="padding:14px">
          <div class="ct-inputrow">
            <div class="ct-swatch" id="ct-swatch"></div>
            <button class="btn" id="ct-random">Random</button>
          </div>

          <label class="ct-label">HEX
            <div class="ct-inputwrap">
              <input id="ct-hex" class="ct-input" value="#21dbf2"/>
              <button class="btn ct-copy" data-copy="hex">Copy</button>
            </div>
          </label>

          <label class="ct-label">RGB
            <div class="ct-inputwrap">
              <input id="ct-rgb" class="ct-input" value="33,219,242"/>
              <button class="btn ct-copy" data-copy="rgb">Copy</button>
            </div>
          </label>

          <label class="ct-label">HSL
            <div class="ct-inputwrap">
              <input id="ct-hsl" class="ct-input" value="187,89%,54%"/>
              <button class="btn ct-copy" data-copy="hsl">Copy</button>
            </div>
          </label>
        </div>

        <div class="ct-right card" style="padding:14px">
          <div class="palette" id="ct-palette">
            <div id="ct-empty" class="palette-empty">Click “Add to palette” to collect swatches.</div>
          </div>
          <div class="ct-row" style="margin-top:10px">
            <button class="btn primary" id="ct-add">Add to palette</button>
            <button class="btn" id="ct-clear">Clear</button>
          </div>
        </div>
      </div>
    </div>
  </section>

<script>
(function(){
  const $ = s => document.querySelector(s);
  const swatch  = $('#ct-swatch');
  const hexI    = $('#ct-hex');
  const rgbI    = $('#ct-rgb');
  const hslI    = $('#ct-hsl');
  const randomB = $('#ct-random');
  const addB    = $('#ct-add');
  const clearB  = $('#ct-clear');
  const palette = $('#ct-palette');
  const empty   = $('#ct-empty');
  const ratioEl = $('#ct-ratio');
  const badgeEl = $('#ct-badge');
  const swapB   = $('#ct-swap');

  let mode = 'bg';
  document.querySelectorAll('input[name="ct-mode"]').forEach(r=>{ r.addEventListener('change',()=>{mode=r.value;updateAll();}) });
  swapB.addEventListener('click',()=>{ mode=(mode==='bg')?'text':'bg'; document.querySelectorAll('input[name="ct-mode"]').forEach(r=>r.checked=(r.value===mode)); updateAll(); });

  function clamp(n,min,max){return Math.min(max,Math.max(min,n))}
  function hexToRgb(h){const x=h.replace('#','').trim(); const v=x.length===3?x.split('').map(c=>c+c).join(''):x; const n=parseInt(v,16);
    if(isNaN(n)||v.length!==6)return null; return {r:(n>>16)&255,g:(n>>8)&255,b:n&255};}
  function rgbToHex(r,g,b){return '#'+[r,g,b].map(v=>clamp(v,0,255).toString(16).padStart(2,'0')).join('').toUpperCase();}
  function rgbStringToRgb(str){const m=str.match(/^\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*$/); if(!m)return null; return {r:+m[1],g:+m[2],b:+m[3]};}
  function hslStringToRgb(str){const m=str.match(/^\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})%\s*,\s*([0-9]{1,3})%\s*$/); if(!m)return null;
    let h=+m[1]/360,s=+m[2]/100,l=+m[3]/100;if(s===0){const v=Math.round(l*255);return{r:v,g:v,b:v}}
    const hue2rgb=(p,q,t)=>{if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p}
    const q=l<.5?l*(1+s):l+s-l*s, p=2*l-q
    const r=Math.round(hue2rgb(p,q,h+1/3)*255), g=Math.round(hue2rgb(p,q,h)*255), b=Math.round(hue2rgb(p,q,h-1/3)*255)
    return {r,g,b}}
  function rgbToHsl(r,g,b){r/=255;g/=255;b/=255;const max=Math.max(r,g,b),min=Math.min(r,g,b);let h,s,l=(max+min)/2;
    if(max===min){h=s=0}else{const d=max-min; s=l>0.5?d/(2-max-min):d/(max+min); switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break} h/=6}
    return {h:Math.round(h*360),s:Math.round(s*100),l:Math.round(l*100)}}
  function luminance(r,g,b){const a=[r,g,b].map(v=>{v/=255;return v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4)});return .2126*a[0]+.7152*a[1]+.0722*a[2]}
  function contrast(rgb1,rgb2){const L1=luminance(rgb1.r,rgb1.g,rgb1.b), L2=luminance(rgb2.r,rgb2.g,rgb2.b); const r=(Math.max(L1,L2)+.05)/(Math.min(L1,L2)+.05); return Math.round(r*100)/100}

  function updateAll(from){
    let rgb;
    if(from==='hex'){ rgb=hexToRgb(hexI.value); if(!rgb)return; rgbI.value=`${rgb.r},${rgb.g},${rgb.b}`; const hsl=rgbToHsl(rgb.r,rgb.g,rgb.b); hslI.value=`${hsl.h},${hsl.s}%,${hsl.l}%`; }
    else if(from==='rgb'){ rgb=rgbStringToRgb(rgbI.value); if(!rgb)return; hexI.value=rgbToHex(rgb.r,rgb.g,rgb.b); const hsl=rgbToHsl(rgb.r,rgb.g,rgb.b); hslI.value=`${hsl.h},${hsl.s}%,${hsl.l}%`; }
    else if(from==='hsl'){ rgb=hslStringToRgb(hslI.value); if(!rgb)return; hexI.value=rgbToHex(rgb.r,rgb.g,rgb.b); rgbI.value=`${rgb.r},${rgb.g},${rgb.b}`; }
    else { rgb=hexToRgb(hexI.value)||rgbStringToRgb(rgbI.value)||hslStringToRgb(hslI.value); if(!rgb)return;
      hexI.value=rgbToHex(rgb.r,rgb.g,rgb.b); rgbI.value=`${rgb.r},${rgb.g},${rgb.b}`; const hsl=rgbToHsl(rgb.r,rgb.g,rgb.b); hslI.value=`${hsl.h},${hsl.s}%,${hsl.l}%`; }

    swatch.style.background = hexI.value;

    const panel={r:0x12,g:0x13,b:0x18}; const ink={r:0xe8,g:0xec,b:0xf1};
    const c = (mode==='bg') ? contrast(rgb, ink) : contrast(rgb, panel);
    ratioEl.textContent = c.toFixed(2)+':1';
    let label='Fail'; if(c>=7) label='AAA'; else if(c>=4.5) label='AA'; else if(c>=3) label='AA-large';
    badgeEl.textContent = label;
  }
  hexI.addEventListener('input',()=>updateAll('hex'));
  rgbI.addEventListener('input',()=>updateAll('rgb'));
  hslI.addEventListener('input',()=>updateAll('hsl'));

  randomB.addEventListener('click',()=>{
    const r=Math.floor(Math.random()*256), g=Math.floor(Math.random()*256), b=Math.floor(Math.random()*256);
    hexI.value = rgbToHex(r,g,b); updateAll('hex');
  });

  document.querySelectorAll('.ct-copy').forEach(btn=>{
    btn.addEventListener('click',()=>{
      const t=btn.dataset.copy, v=(t==='hex'?hexI.value: t==='rgb'?rgbI.value:hslI.value);
      navigator.clipboard?.writeText(v); btn.textContent='Copied'; setTimeout(()=>btn.textContent='Copy',900);
    });
  });

  function addChip(hex){ const chip=document.createElement('div'); chip.className='chip'; chip.style.background=hex; chip.innerHTML=`<b>${hex.toUpperCase()}</b>`;
    chip.title='Click to copy'; chip.addEventListener('click',()=>navigator.clipboard?.writeText(hex)); palette.appendChild(chip); }

  addB.addEventListener('click',()=>{ empty?.remove(); addChip(hexI.value); });
  clearB.addEventListener('click',()=>{ palette.innerHTML=''; palette.appendChild(empty); });

  updateAll();
})();
</script>
</body>
</html>
